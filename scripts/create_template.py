import pandas as pd
from datetime import datetime, timedelta
import random

# 创建示例数据文件，展示标准导入格式

# 1. 项目数据
projects_data = {
    '项目编号': ['YT-2024-001', 'YT-2024-002'],
    '游艇名称': ['海鹰号', '蓝鲸号'],
    '船型': ['HY-65', 'LJ-80'],
    '船东': ['张三', '李四'],
    '状态': ['进行中', '规划中'],
    '开始日期': ['2024-01-15', '2024-03-01'],
    '计划结束日期': ['2024-06-30', '2024-09-30'],
    '备注': ['铝合金飞桥游艇', '豪华定制款']
}

# 2. 任务时间轴数据
tasks_data = {
    '序号': ['1.1', '1.2', '1.3', '2.1', '2.2'],
    '项目/任务名称': [
        '飞桥结构设计交付',
        '船体结构生产放样及制作',
        '外板及甲板矫正',
        '电气系统设计',
        '动力系统安装'
    ],
    '任务类型': ['设计', '船体制作', '船体制作', '设计', '舾装'],
    '状态': ['已完成', '进行中', '未开始', '已完成', '未开始'],
    '计划开始': ['2024-01-15', '2024-02-01', '2024-03-01', '2024-01-20', '2024-04-01'],
    '计划结束': ['2024-02-15', '2024-04-30', '2024-05-15', '2024-02-20', '2024-05-30'],
    '实际开始': ['2024-01-15', '2024-02-01', '', '2024-01-20', ''],
    '实际结束': ['2024-02-10', '', '', '2024-02-18', ''],
    '计划工时': [240, 480, 320, 200, 400],
    '实际工时': [220, 300, 0, 190, 0],
    '进度%': [100, 65, 0, 100, 0],
    '延期天数': [0, 5, 0, 0, 0],
    '延期原因': ['', '材料延迟到货', '', '', '']
}

# 3. 物料数据
materials_data = {
    '物料编码': ['AL-001', 'AL-002', 'WELD-001', 'ELEC-001'],
    '物料名称': ['4mm铝合金板', '铝合金型材', '铝合金焊丝', '船用电缆'],
    '品牌': ['CCS', 'CCS', 'ER5356', '南洋'],
    '型号/规格': ['5083-H116', '6061-T6', '1.2mm', '3x2.5mm²'],
    '单位': ['平米', '米', 'kg', '米'],
    '供应商': ['中铝', '中铝', '大西洋', '南洋电缆'],
    '单价': [280, 45, 35, 12],
    '最低库存': [100, 500, 50, 1000],
    '描述': ['船体用铝板', '骨架型材', 'MIG焊丝', '动力电缆']
}

# 4. 采购数据
procurement_data = {
    '采购单号': ['PO-2024-001', 'PO-2024-002'],
    '物料名称': ['4mm铝合金板', '铝合金焊丝'],
    '数量': [200, 500],
    '单位': ['平米', 'kg'],
    '单价': [280, 35],
    '总价': [56000, 17500],
    '供应商': ['中铝', '大西洋'],
    '采购日期': ['2024-01-05', '2024-01-10'],
    '交货日期': ['2024-01-20', '2024-01-25'],
    '状态': ['已到货', '已下单']
}

# 5. 部门数据
departments_data = {
    '部门名称': ['设计部', '生产部', '采购部', '质检部', '综合部'],
    '部门编码': ['DEPT-DESIGN', 'DEPT-PROD', 'DEPT-PROC', 'DEPT-QC', 'DEPT-ADMIN'],
    '描述': ['游艇设计、结构设计', '船体制作、舾装', '物料采购', '质量检测', '行政财务']
}

# 6. 班组数据
teams_data = {
    '班组名称': ['结构设计组', '铝合金班组', '焊接班组', '采购组', '质检组'],
    '班组编码': ['TEAM-STRUCT', 'TEAM-ALUM', 'TEAM-WELD', 'TEAM-PROC', 'TEAM-QC'],
    '所属部门': ['设计部', '生产部', '生产部', '采购部', '质检部'],
    '专业领域': ['结构设计', '船体制作', '焊接工艺', '物料采购', '质量检测']
}

# 7. 用户数据
users_data = {
    '用户名': ['admin', 'zhangsan', 'lisi', 'wangwu'],
    '姓名': ['管理员', '张三', '李四', '王五'],
    '电话': ['13800138000', '13900139000', '13700137000', '13600136000'],
    '邮箱': ['admin@yacht.com', 'zs@yacht.com', 'ls@yacht.com', 'ww@yacht.com'],
    '角色': ['管理员', '部门领导', '班组长', '工人'],
    '部门': ['综合部', '设计部', '生产部', '生产部'],
    '班组': ['', '', '铝合金班组', '焊接班组']
}

# 创建 Excel 文件
output_path = '/root/.openclaw/workspace/yacht-mes/data_template.xlsx'

with pd.ExcelWriter(output_path, engine='openpyxl') as writer:
    pd.DataFrame(projects_data).to_excel(writer, sheet_name='项目', index=False)
    pd.DataFrame(tasks_data).to_excel(writer, sheet_name='时间轴', index=False)
    pd.DataFrame(materials_data).to_excel(writer, sheet_name='物料', index=False)
    pd.DataFrame(procurement_data).to_excel(writer, sheet_name='采购', index=False)
    pd.DataFrame(departments_data).to_excel(writer, sheet_name='部门', index=False)
    pd.DataFrame(teams_data).to_excel(writer, sheet_name='班组', index=False)
    pd.DataFrame(users_data).to_excel(writer, sheet_name='用户', index=False)

print(f"✅ 示例数据模板已创建: {output_path}")
print("\n包含以下工作表:")
print("  - 项目: 游艇项目基本信息")
print("  - 时间轴: 建造任务计划与实际进度")
print("  - 物料: 物料清单与库存设置")
print("  - 采购: 采购订单信息")
print("  - 部门: 部门组织架构")
print("  - 班组: 生产班组信息")
print("  - 用户: 系统用户账号")
