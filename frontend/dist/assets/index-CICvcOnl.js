import{d as R,u as X,c as _,b as l,w as a,n as c,v as m,j as w,r as s,o as r,a as e,i as p,F as y,m as h,t as $,q as Z,E as b}from"./index-DejdUQV-.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";const le={class:"data-import"},te={class:"card-header"},ae=R({__name:"index",setup(se){const z=X(),o=w(null),V=w("projects"),B=w(["1"]),N=Z(()=>({Authorization:`Bearer ${z.token}`})),T=n=>({projects:"é¡¹ç›®",tasks:"ä»»åŠ¡",materials:"ç‰©æ–™",procurement:"é‡‡è´­",departments:"éƒ¨é—¨",teams:"ç­ç»„",users:"ç”¨æˆ·"})[n]||n,F=n=>{const t=n.name.endsWith(".xlsx")||n.name.endsWith(".xls"),f=n.size/1024/1024<10;return t?f?!0:(b.error("æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡ 10MB"),!1):(b.error("åªæ”¯æŒ .xlsx æˆ– .xls æ–‡ä»¶"),!1)},L=n=>{var t;o.value=n,((t=n.errors)==null?void 0:t.length)>0?b.warning(`å¯¼å…¥å®Œæˆï¼Œä½†æœ‰ ${n.errors.length} ä¸ªé”™è¯¯`):b.success("æ•°æ®å¯¼å…¥æˆåŠŸ")},W=n=>{b.error(n.message||"æ–‡ä»¶ä¸Šä¼ å¤±è´¥")},q=()=>{b.info("æ¨¡æ¿ä¸‹è½½åŠŸèƒ½å¼€å‘ä¸­")};return(n,t)=>{const f=s("el-page-header"),A=s("Download"),D=s("el-icon"),H=s("el-button"),I=s("Upload"),G=s("el-upload"),g=s("el-card"),J=s("el-statistic"),K=s("el-col"),O=s("el-row"),u=s("el-table-column"),x=s("el-table"),k=s("el-tab-pane"),P=s("el-tabs"),M=s("el-alert"),Y=s("el-collapse-item"),Q=s("el-collapse");return r(),_("div",le,[l(f,{title:"æ•°æ®å¯¼å…¥",content:"ä» Excel å¯¼å…¥é¡¹ç›®ã€ä»»åŠ¡ã€ç‰©æ–™ç­‰åˆå§‹æ•°æ®",onBack:t[0]||(t[0]=v=>n.$router.back())}),l(g,{class:"import-card"},{header:a(()=>[e("div",te,[t[4]||(t[4]=e("span",null,"ğŸ“ ä¸Šä¼  Excel æ–‡ä»¶",-1)),l(H,{type:"primary",link:"",onClick:q},{default:a(()=>[l(D,null,{default:a(()=>[l(A)]),_:1}),t[3]||(t[3]=p(" ä¸‹è½½æ¨¡æ¿ ",-1))]),_:1})])]),default:a(()=>[l(G,{class:"upload-area",drag:"",action:"/api/import/excel",headers:N.value,"on-success":L,"on-error":W,"before-upload":F,accept:".xlsx,.xls"},{tip:a(()=>[...t[5]||(t[5]=[e("div",{class:"upload-tip"},[p(" æ”¯æŒ .xlsx, .xls æ ¼å¼ï¼Œæ–‡ä»¶å¤§å°ä¸è¶…è¿‡ 10MB "),e("br"),p(" è¯·æŒ‰ç…§æ¨¡æ¿æ ¼å¼å‡†å¤‡æ•°æ® ")],-1)])]),default:a(()=>[l(D,{class:"upload-icon"},{default:a(()=>[l(I)]),_:1}),t[6]||(t[6]=e("div",{class:"upload-text"},[p(" æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„ï¼Œæˆ–"),e("em",null,"ç‚¹å‡»ä¸Šä¼ ")],-1))]),_:1},8,["headers"])]),_:1}),o.value?(r(),c(g,{key:0,class:"preview-card"},{header:a(()=>[...t[7]||(t[7]=[e("div",{class:"card-header"},[e("span",null,"ğŸ“Š å¯¼å…¥ç»“æœ")],-1)])]),default:a(()=>{var v,j;return[l(O,{gutter:20,class:"stats-row"},{default:a(()=>[(r(!0),_(y,null,h(o.value.preview,(d,i)=>(r(),c(K,{span:4,key:i},{default:a(()=>[l(J,{title:T(i),value:d},null,8,["title","value"])]),_:2},1024))),128))]),_:1}),l(P,{modelValue:V.value,"onUpdate:modelValue":t[1]||(t[1]=d=>V.value=d),class:"preview-tabs"},{default:a(()=>{var d,i,E,C,S,U;return[(i=(d=o.value.sample_data)==null?void 0:d.projects)!=null&&i.length?(r(),c(k,{key:0,label:"é¡¹ç›®",name:"projects"},{default:a(()=>[l(x,{data:o.value.sample_data.projects,size:"small"},{default:a(()=>[l(u,{prop:"project_no",label:"é¡¹ç›®ç¼–å·"}),l(u,{prop:"yacht_name",label:"æ¸¸è‰‡åç§°"}),l(u,{prop:"yacht_model",label:"èˆ¹å‹"}),l(u,{prop:"status",label:"çŠ¶æ€"})]),_:1},8,["data"])]),_:1})):m("",!0),(C=(E=o.value.sample_data)==null?void 0:E.tasks)!=null&&C.length?(r(),c(k,{key:1,label:"ä»»åŠ¡",name:"tasks"},{default:a(()=>[l(x,{data:o.value.sample_data.tasks,size:"small"},{default:a(()=>[l(u,{prop:"task_no",label:"åºå·",width:"80"}),l(u,{prop:"name",label:"ä»»åŠ¡åç§°"}),l(u,{prop:"task_type",label:"ç±»å‹"}),l(u,{prop:"status",label:"çŠ¶æ€"})]),_:1},8,["data"])]),_:1})):m("",!0),(U=(S=o.value.sample_data)==null?void 0:S.materials)!=null&&U.length?(r(),c(k,{key:2,label:"ç‰©æ–™",name:"materials"},{default:a(()=>[l(x,{data:o.value.sample_data.materials,size:"small"},{default:a(()=>[l(u,{prop:"code",label:"ç‰©æ–™ç¼–ç "}),l(u,{prop:"name",label:"ç‰©æ–™åç§°"}),l(u,{prop:"brand",label:"å“ç‰Œ"}),l(u,{prop:"unit",label:"å•ä½"})]),_:1},8,["data"])]),_:1})):m("",!0)]}),_:1},8,["modelValue"]),(v=o.value.warnings)!=null&&v.length?(r(),c(M,{key:0,title:`è­¦å‘Š (${o.value.warnings.length})`,type:"warning",closable:!1,class:"alert-box"},{default:a(()=>[e("ul",null,[(r(!0),_(y,null,h(o.value.warnings,(d,i)=>(r(),_("li",{key:i},$(d),1))),128))])]),_:1},8,["title"])):m("",!0),(j=o.value.errors)!=null&&j.length?(r(),c(M,{key:1,title:`é”™è¯¯ (${o.value.errors.length})`,type:"error",closable:!1,class:"alert-box"},{default:a(()=>[e("ul",null,[(r(!0),_(y,null,h(o.value.errors,(d,i)=>(r(),_("li",{key:i},$(d),1))),128))])]),_:1},8,["title"])):m("",!0)]}),_:1})):m("",!0),l(g,{class:"help-card"},{header:a(()=>[...t[8]||(t[8]=[e("span",null,"ğŸ“– å¯¼å…¥è¯´æ˜",-1)])]),default:a(()=>[l(Q,{modelValue:B.value,"onUpdate:modelValue":t[2]||(t[2]=v=>B.value=v)},{default:a(()=>[l(Y,{title:"æ”¯æŒçš„ Sheet åç§°",name:"1"},{default:a(()=>[...t[9]||(t[9]=[e("ul",null,[e("li",null,[e("strong",null,"é¡¹ç›®"),p(" - æ¸¸è‰‡é¡¹ç›®åŸºæœ¬ä¿¡æ¯")]),e("li",null,[e("strong",null,"æ—¶é—´è½´"),p(" - å»ºé€ ä»»åŠ¡è®¡åˆ’ä¸å®é™…è¿›åº¦")]),e("li",null,[e("strong",null,"ç‰©æ–™"),p(" - ç‰©æ–™æ¸…å•ä¸åº“å­˜è®¾ç½®")]),e("li",null,[e("strong",null,"é‡‡è´­"),p(" - é‡‡è´­è®¢å•ä¿¡æ¯")]),e("li",null,[e("strong",null,"éƒ¨é—¨"),p(" - éƒ¨é—¨ç»„ç»‡æ¶æ„")]),e("li",null,[e("strong",null,"ç­ç»„"),p(" - ç”Ÿäº§ç­ç»„ä¿¡æ¯")]),e("li",null,[e("strong",null,"ç”¨æˆ·"),p(" - ç³»ç»Ÿç”¨æˆ·è´¦å·")])],-1)])]),_:1}),l(Y,{title:"æ•°æ®æ ¼å¼è¦æ±‚",name:"2"},{default:a(()=>[...t[10]||(t[10]=[e("ul",null,[e("li",null,"æ—¥æœŸæ ¼å¼: YYYY-MM-DD æˆ– YYYY/MM/DD"),e("li",null,"çŠ¶æ€å€¼: æœªå¼€å§‹/è¿›è¡Œä¸­/å·²å®Œæˆ/å»¶æœŸ/å·²å–æ¶ˆ"),e("li",null,"è§’è‰²å€¼: ç®¡ç†å‘˜/éƒ¨é—¨é¢†å¯¼/ç­ç»„é•¿/å·¥äºº"),e("li",null,"æ•°å­—å­—æ®µ: æ”¯æŒæ•´æ•°å’Œå°æ•°")],-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})])}}}),re=ee(ae,[["__scopeId","data-v-8bd72227"]]);export{re as default};
//# sourceMappingURL=index-CICvcOnl.js.map
