# 铝合金电动游艇建造管理系统 (Yacht MES)

> 基于 OpenClaw/Kimi 架构的工业级 MES + PLM 系统
> 创建时间：2026-02-16

---

## 系统概述

这是一个融合传统 MES（制造执行系统）、PLM（产品生命周期管理）与现代 AI Agent 的工业互联网平台，专为铝合金电动游艇建造场景设计。

### 核心特性

- **AI 原生架构**：基于 LLM 重新设计流程，而非传统软件的"AI 化改造"
- **多模态能力**：直接解析 CAD 图纸（DWG/DXF）、工艺文档 PDF
- **Agent 架构**：每个生产环节配置独立 Agent（配件 Agent、焊接 Agent、质检 Agent）
- **知识沉淀**：老师傅工艺经验通过对话录入，转化为可检索知识

---

## 技术栈

| 层级 | 技术选型 |
|------|----------|
| 后端 | Python FastAPI + OpenClaw 框架扩展 |
| 数据库 | PostgreSQL (主) + 向量库 (图纸/文档) |
| 缓存/消息 | Redis / RabbitMQ |
| 前端 | Vue3 + WebGL (Three.js) + PWA |
| 文件存储 | MinIO (图纸/检测报告) |
| AI | Kimi API + 本地微调模型 |
| 移动端 | Capacitor 封装 |

---

## 系统架构图

```
┌─────────────────────────────────────────────────────────────┐
│                    用户接入层                               │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐      │
│  │   Web 后台   │  │  移动端 App  │  │   船东门户   │      │
│  └──────────────┘  └──────────────┘  └──────────────┘      │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                    API Gateway                              │
│              (HTTPS / WebSocket)                            │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                    FastAPI 后端服务                         │
│  ┌────────────┐ ┌────────────┐ ┌────────────┐              │
│  │ 建造管理   │ │ 采购库存   │ │ 质量检测   │              │
│  └────────────┘ └────────────┘ └────────────┘              │
│  ┌────────────┐ ┌────────────┐ ┌────────────┐              │
│  │ 用户权限   │ │ 工作流引擎 │ │ 报表导出   │              │
│  └────────────┘ └────────────┘ └────────────┘              │
└─────────────────────────────────────────────────────────────┘
                              │
            ┌─────────────────┼─────────────────┐
            ▼                 ▼                 ▼
    ┌──────────────┐  ┌──────────────┐  ┌──────────────┐
    │  PostgreSQL  │  │    Redis     │  │    MinIO     │
    │   (主数据库)  │  │ (缓存/消息)  │  │  (文件存储)  │
    └──────────────┘  └──────────────┘  └──────────────┘
                              │
                              ▼
    ┌──────────────────────────────────────────────────────┐
    │                    AI 服务层                         │
    │  ┌────────────┐  ┌────────────┐  ┌────────────┐     │
    │  │  Kimi API  │  │  RAG 检索  │  │  知识库    │     │
    │  └────────────┘  └────────────┘  └────────────┘     │
    └──────────────────────────────────────────────────────┘
```

---

## 核心功能模块

### 1. 用户权限系统 (RBAC)

四级权限层级：

| 角色 | 权限范围 |
|------|----------|
| Admin | 查看所有项目、配置系统、管理用户 |
| Dept Manager | 查看本部门所有任务，审批采购 |
| Team Leader | 查看本组任务，分配工作，确认完工 |
| Worker | 查看分配给自己的任务，上传照片，报工 |

### 2. 建造时间轴管理

- 从 Excel 导入初始数据生成甘特图
- 关键路径自动计算（船体制作→舾装→内装→下水）
- 延期预警（基于预计提前/滞后天数）
- 移动端离线报工

### 3. 智能采购与库存联动

- 任务启动自动触发物料需求计算（MRP）
- 库存不足自动生成采购申请
- 到货入库自动关联任务
- AI 采购建议（紧急采购清单、供应商比价、库存优化）

### 4. 质量检测与测试验收

- 检验计划生成（根据 CCS/ABS 船级社规范）
- 移动端质检：拍照上传缺陷，AI 辅助定级
- 水密/电气测试数据实时采集
- 验收文档自动生成（船检证书、质量证明书）

### 5. AI 功能集成

- **自然语言查询**："查询铝合金班组本周延迟的任务" → SQL → 结果
- **工艺知识助手**：语音提问，RAG 检索知识库返回答案
- **生产瓶颈预测**：基于历史数据识别延期风险
- **智能日报生成**：自动汇总当日生产情况

---

## 实施路线图

### Phase 1：基础平台（2-3 周）
- [x] 部署数据库和基础 API
- [x] 导入 Excel 数据（时间轴、部门、物料）
- [x] 实现基础用户登录和任务看板

### Phase 2：业务功能（3-4 周）
- [ ] 采购申请和审批流程
- [ ] 库存出入库管理
- [ ] 移动端 PWA 适配（离线报工）

### Phase 3：AI 能力（2-3 周）
- [ ] 接入 Kimi API 实现自然语言查询
- [ ] 建立工艺知识库 RAG 系统
- [ ] 智能报表和预警

### Phase 4：持续优化
- [ ] 对接 IoT 设备（焊接机、数控切割机）
- [ ] 数字孪生 3D 可视化
- [ ] 供应商门户、船东端

## 快速开始

```bash
# 1. 启动所有服务
cd yacht-mes
./start.sh

# 2. 访问系统
http://localhost:8080

# 3. 默认账号
用户名: admin
密码: admin

# 4. 数据导入（管理员）
进入 系统设置 > 数据导入，上传 Excel 文件
或参考 data_template.xlsx 模板格式
```

## 数据导入

系统支持从 Excel 导入以下数据：

| Sheet 名称 | 说明 | 必需字段 |
|------------|------|----------|
| 项目 | 游艇项目基本信息 | 项目编号、游艇名称 |
| 时间轴 | 建造任务计划 | 序号、任务名称、任务类型 |
| 物料 | 物料清单 | 物料名称、单位 |
| 采购 | 采购订单 | 物料名称、数量、供应商 |
| 部门 | 组织架构 | 部门名称 |
| 班组 | 生产班组 | 班组名称、所属部门 |
| 用户 | 系统账号 | 用户名、姓名、角色 |

模板文件：`data_template.xlsx`

---

## 项目结构

```
yacht-mes/
├── backend/              # FastAPI 后端
│   ├── app/
│   │   ├── main.py       # 应用入口
│   │   ├── routers/      # API 路由
│   │   ├── models/       # 数据库模型
│   │   ├── schemas/      # Pydantic 模型
│   │   ├── services/     # 业务服务
│   │   └── utils/        # 工具函数
│   ├── tests/            # 测试用例
│   └── requirements.txt
├── frontend/             # Vue3 前端
│   ├── src/
│   │   ├── views/        # 页面组件
│   │   ├── components/   # 公共组件
│   │   ├── api/          # API 接口
│   │   └── stores/       # Pinia 状态
│   └── package.json
├── database/             # 数据库
│   └── schema.sql        # 完整表结构
├── docs/                 # 文档
│   ├── api.md            # API 文档
│   └── deployment.md     # 部署指南
├── scripts/              # 脚本
│   ├── start.sh          # 启动脚本
│   ├── backup.sh         # 备份脚本
│   └── verify.sh         # 验证脚本
├── docker-compose.yml    # Docker 编排
└── README.md
```

## 功能特性

### ✅ 已完成

**核心功能**
- [x] 用户权限管理 (RBAC)
- [x] 项目管理
- [x] 任务管理 (甘特图/报工)
- [x] 物料管理
- [x] 采购管理 (审批流程)
- [x] 库存管理 (出入库/预警)
- [x] 数据导入 (Excel)

**AI 功能**
- [x] 自然语言查询
- [x] 采购建议
- [x] 日报生成
- [x] 工艺知识库

**系统功能**
- [x] 通知系统
- [x] 审计日志
- [x] 缓存优化 (Redis)
- [x] PWA 移动端适配
- [x] 测试用例 (pytest)

**文档**
- [x] API 文档
- [x] 部署指南
- [x] 项目结构说明

## 技术栈

| 层级 | 技术 |
|------|------|
| 后端 | Python 3.11 + FastAPI + SQLAlchemy |
| 前端 | Vue 3 + TypeScript + Element Plus |
| 数据库 | PostgreSQL 15 |
| 缓存 | Redis 7 |
| 文件存储 | MinIO |
| 容器 | Docker + Docker Compose |
| 测试 | pytest + httpx |

## 项目信息

- **创建者**: Kimi Claw + Kimi AI
- **创建时间**: 2026-02-16
- **版本**: v1.0.0
- **许可证**: MIT
